<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:BasculaInterface.ViewModels"
             x:Class="BasculaInterface.Views.PendingWeightsView"
             Title="Pedidos en Proceso">
    <ContentPage.BindingContext>
        <vm:PendingWeightsViewModel/>
    </ContentPage.BindingContext>

    <Grid RowDefinitions="1*,9*">
        <Grid ColumnDefinitions="*,*">
            <Button x:Name="BtnReconnect" Text="Reconectar" Clicked="BtnReconnect_Clicked" Grid.Column="0" IsVisible="False"/>
            <Button x:Name="BtnNewWeighProcess" Text="Nueva Entrada" Clicked="BtnNewWeighProcess_Clicked" Grid.Column="1" IsVisible="False"/>
        </Grid>
        <CollectionView ItemsSource="{Binding PendingWeights}" Margin="8" SelectionMode="Single" x:Name="PendingWeightsCollectionView" SelectionChanged="PendingWeightsCollectionView_SelectionChanged" Grid.Row="1">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame CornerRadius="4" Padding="2" BackgroundColor="Transparent" BorderColor="Transparent">
                        <Frame Padding="10"
                                BackgroundColor="#F7F7F7"
                                CornerRadius="4"
                                HasShadow="False">
                            <Grid ColumnDefinitions="*,*">
                                <VerticalStackLayout Spacing="4" Grid.Column="0">
                                    <Label Text="{Binding Partner.RazonSocial}"
                                            FontAttributes="Bold"
                                            FontSize="Subtitle"
                                            TextColor="#222" />

                                    <Label Text="{Binding WeightEntry.VehiclePlate}"
                                            FontSize="Subtitle"
                                            TextColor="#666" />

                                </VerticalStackLayout>

                                <VerticalStackLayout Spacing="4" Grid.Column="1">

                                    <Label Text="{Binding WeightEntry.TareWeight, StringFormat='Tara: {0}'}"
                                            FontAttributes="Bold"
                                            FontSize="Subtitle"
                                            TextColor="#222" 
                                            HorizontalTextAlignment="End"/>

                                    <Label Text="{Binding HistoryText}"
                                            FontSize="Body"
                                            TextColor="DarkOrange" 
                                            HorizontalTextAlignment="End"/>

                                </VerticalStackLayout>
                            </Grid>
                        </Frame>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>